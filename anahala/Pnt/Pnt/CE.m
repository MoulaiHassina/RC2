N = 30;

     nodes= [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30];

node_sizes= [3 2 3 2 3 2 3 2 3 2  3  2  3  2  3  2  3  2  3  2  3  2  3  2  3  2  3  2  3  2];

dag=zeros(N,N);

dag=[
     0     0     0     0     0     0     0     0     0     1     0     0     1     0     0     0     0     0     0     0     0     0     0	    0     0     0     0     0     0     0			;
     0     0     0     0     0     0     1     1     0     0     0     0     1     1     0     0     0     0     0     0     0     0     0      0     0     0     0     0     0     0			;
     0     0     0     0     0     1     0     1     1     0     0     0     0     1     0     0     0     0     0     0     0     0     0	    1     1     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     1     0     0     0     0     0     1     0     0     0     0     0     1     0     1	    0     0     0     0     0     1     0			;
     0     0     0     0     0     0     0     1     0     0     1     1     0     0     1     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     1     0     0     1     0     0     0     0     0     1     0     0     1     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     1     0     0     0     0     1     0     0     1     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     1     0     0     1     1     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     1     0     1     0     1     1     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     1     1     0     0     1     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     1     0     0     1     0     0     1     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     1     0     1     1     0     1     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     1     0     1     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     1     1     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     1     1     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     1     0     0     0     0     0     0		0     0     0     0     1     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     1     1     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     1     0     0     1			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     1     0     0     0     1			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     1     0		0     0     1     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0	    0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			;
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0		0     0     0     0     0     0     0			];
 
pnet = mk_pnet(dag, node_sizes, nodes);

pnet.CPD{1} = tabular_CPD(pnet, 1,[1 0.9262 0.8032]); 
pnet.CPD{2} = tabular_CPD(pnet, 2,[1 0.2527]); 
pnet.CPD{3} = tabular_CPD(pnet, 3,[1 0 0.9024]); 
pnet.CPD{4} = tabular_CPD(pnet, 4,[1 0.4401]); 
pnet.CPD{5} = tabular_CPD(pnet, 5,[1 0.2470 0.8680]); 
pnet.CPD{6} = tabular_CPD(pnet, 6,[0.9574 1 0.7566 1 0.9444 1]); 
pnet.CPD{7} = tabular_CPD(pnet, 7,[0 1 1 0.6779 0.5250 0]); 
pnet.CPD{8} = tabular_CPD(pnet, 8,[   0    1.0000  0    1.0000    0.6924    1.0000    0.6092    1.0000    0.2819    1.0000    0.9295    1.0000    0.7460    1.0000     0.2596    1.0000         0    1.0000    0.4061    1.0000    0.4251    1.0000         0    1.0000    0.6935    1.0000    0.3489    1.0000          0    1.0000    0.2239    1.0000    0.4372    1.0000    0.9685    1.0000    1.0000    0.6318    1.0000    0.7712    1.0000    0.8684     1.0000    0.5088    1.0000    0.3794    1.0000    0.6058    1.0000    0.5384    1.0000    0.7927    1.0000    0.3155    1.0000    0.5428     1.0000         0    1.0000    0.4250    1.0000    0.8443    1.0000    0.4577    1.0000    0.4626    1.0000    0.4721    1.0000    0.5793   1.0000    0.6811]); 
pnet.CPD{9} = tabular_CPD(pnet, 9,[0 1 0.6838 1 0.9454 1 1 0.4036 1 0.2803 1 0.7907 0.8598 0.9559 0.4782 0.7880 0.8706 0.7643]); 
pnet.CPD{10} = tabular_CPD(pnet, 10,[0.5059 1 0.6073 1 0.5819 1]); 
pnet.CPD{11} = tabular_CPD(pnet, 11,[0.3589 1 0.4853 1 0.6291 1 1 0.2260 1 0.6181 1 0.3171 0 0.9536 0.7929 0.8137 0.4283 0.7371]); 
pnet.CPD{12} = tabular_CPD(pnet, 12,[0.2325 1 0 1 0.9717 1 0 1 0.9109 1 0.9685 1 0.9960 1 0.6271 1 0.3453 1]); 
pnet.CPD{13} = tabular_CPD(pnet, 13,[0.8098    1.0000    0.3352    1.0000    0.5819    1.0000         0    1.0000    0.2125    1.0000    0.6173    1.0000    0.9467    1.0000     0.7826    1.0000    0.9644    1.0000    0.5502    1.0000    0.8792    1.0000    0.4027    1.0000    0.8024    1.0000    0.2149    1.0000    0.7636    1.0000    0.4795    1.0000    0.2481    1.0000    0.5977    1.0000    1.0000    0.4430    1.0000    0.7441    1.0000    0.6901     1.0000         0    1.0000    0.4519    1.0000    0.5999    1.0000    0.1914    1.0000    0.9187    1.0000    0.6953    1.0000    0.7792    1.0000    0.9363    1.0000    0.7895    1.0000    0.2341    1.0000    0.9284    1.0000    0.8147    1.0000    0.5617    1.0000    0.8266    1.0000         0    0.6897    0.8458    0.7012    0.3015    0.7930         0    0.1742    0.2948    0.5725    0.9856    0.6167    0.1619    0.9883    0.5171         0    0.2705    0.6005    0.8224    0.7301    0.3184    0.7020    0.5854    0.6817         0    0.4057    0.9925         0    0.7667    0.7385    0.8087    0.3486    0.9436    0.6620    0.9830    0.4421    0.3588]);
pnet.CPD{14} = tabular_CPD(pnet, 14,[    0.3273    1.0000    0.9658    1.0000    0.9713    1.0000         0    1.0000    0.6240    1.0000    0.6267    1.0000    0.4810    1.0000    0.7462    1.0000    0.3412    1.0000    0.4914    1.0000         0    1.0000    0.4876    1.0000    0.5322    1.0000    0.3231    1.0000     0.1585    1.0000    0.7940    1.0000    0.4388    1.0000    0.3665    1.0000    1.0000         0    1.0000    0.6351    1.0000         0    1.0000         0    1.0000    0.3723    1.0000    0.1709    1.0000    0.5120    1.0000    0.9052    1.0000    0.9556    1.0000    0.7248    1.0000    0.9292    1.0000    0.9119    1.0000    0.3146    1.0000    0.5572    1.0000    0.2550    1.0000    0.1683    1.0000         0    1.0000    0.1569]); 
pnet.CPD{15} = tabular_CPD(pnet, 15,[    0.2814    1.0000    0.6140    1.0000         0    1.0000    0.7899    1.0000         0    1.0000    0.8767    1.0000    0.5502    1.0000    0.9484    1.0000    0.5437    1.0000    0.4127    1.0000    0.9578    1.0000    0.4496    1.0000    0.7777    1.0000    0.9630    1.0000    0.6209    1.0000    0.3259    1.0000    0.5932    1.0000         0    1.0000    1.0000    0.2189    1.0000    0.3424    1.0000    0.8130    1.0000    0.6711    1.0000    0.4189    1.0000         0    1.0000    0.8910    1.0000    0.5374    1.0000    0.9349    1.0000         0    1.0000         0    1.0000    0.2116    1.0000    0.6978    1.0000    0.5761    1.0000    0.6067    1.0000    0.7903    1.0000         0    1.0000    0.3576    0.2432    0.2067    0.7558    0.2933    0.8197    0.7712    0.8933    0.4401    0.8448    0.3823         0    0.6411    0.9562    0.3237    0.5356    0.6620    0.5757    0.7973    0.6400    0.2077    0.2056    0.9231    0.3785         0    0.6724         0    0.4716    0.5281    0.6130    0.5756    0.2962    0.9313    0.5121    0.3396    0.9405    0.1898]);
pnet.CPD{16} = tabular_CPD(pnet, 16,[    0.4698    1.0000    0.4413    1.0000    0.4080    1.0000    0.3550    1.0000         0    1.0000    0.7357    1.0000    0.4033    1.0000    0.3914    1.0000    0.3325    1.0000    0.6357    1.0000    0.3281    1.0000         0    1.0000         0    1.0000         0    1.0000    0.3045    1.0000    0.8135    1.0000    0.3369    1.0000    0.3609    1.0000    0.7659    1.0000         0    1.0000    0.9551    1.0000    0.7870    1.0000    0.6882    1.0000    0.2440    1.0000    0.3691    1.0000    0.6835    1.0000    0.3126    1.0000    0.1974    1.0000    0.2505    1.0000    0.4851    1.0000    0.6703    1.0000    0.6413    1.0000    0.6419    1.0000    0.8466    1.0000    0.6383    1.0000         0    1.0000    1.0000         0    1.0000    0.3051    1.0000    0.5228    1.0000    0.8848    1.0000    0.5964    1.0000    0.2015    1.0000    0.8941    1.0000    0.4770    1.0000    0.4605    1.0000    0.2542    1.0000    0.8908    1.0000    0.6084    1.0000    0.7967    1.0000    0.3929    1.0000    0.2718    1.0000    0.5044    1.0000    0.3155    1.0000    0.7871    1.0000    0.7661    1.0000    0.4188    1.0000    0.8402    1.0000         0    1.0000    0.6042    1.0000    0.6387    1.0000    0.6871    1.0000    0.2924    1.0000    0.1524    1.0000    0.6706    1.0000    0.1654    1.0000    0.9530    1.0000    0.9443    1.0000    0.3992    1.0000    0.8333    1.0000         0    1.0000    0.4242    1.0000    0.7930]);
pnet.CPD{17} = tabular_CPD(pnet, 17,[        
         0    1.0000         0    1.0000    0.9968    1.0000    0.9252    1.0000    0.2527    1.0000    0.1580    1.0000    0.8308    1.0000 ...
    0.4891    1.0000    0.6475    1.0000         0    1.0000    0.9298    1.0000    0.2207    1.0000    0.2870    1.0000    0.3605    1.0000 ...
    0.7015    1.0000    0.6923    1.0000         0    1.0000         0    1.0000    0.9221    1.0000    0.7480    1.0000    0.1831    1.0000 ...
    0.2008    1.0000    0.3736    1.0000    0.2937    1.0000    0.8700    1.0000    0.6410    1.0000    0.6392    1.0000    0.7326    1.0000 ...
    0.8009    1.0000    0.2831    1.0000    0.4104    1.0000         0    1.0000    0.8004    1.0000    0.5569    1.0000    0.3589    1.0000 ...
    0.3515    1.0000    0.2513    1.0000         0    1.0000    0.5127    1.0000    0.2575    1.0000    0.8330    1.0000    0.5994    1.0000 ...
    0.8643    1.0000         0    1.0000    0.8445    1.0000    0.6451    1.0000    0.6819    1.0000    0.3998    1.0000    0.9314    1.0000 ...
    0.4211    1.0000    0.1881    1.0000    0.9898    1.0000    0.3673    1.0000    0.6846    1.0000         0    1.0000    0.3772    1.0000 ...
         0    1.0000    0.4146    1.0000    0.2683    1.0000    0.9211    1.0000    0.2842    1.0000    0.6210    1.0000    0.4639    1.0000 ... 
    0.2832    1.0000    0.3249    1.0000    0.3600    1.0000         0    1.0000    0.8761    1.0000    0.1906    1.0000         0    1.0000 ...
    0.7585    1.0000    0.7081    1.0000    0.6133    1.0000    0.2814    1.0000    0.2528    1.0000    0.7878    1.0000         0    1.0000 ...
         0    1.0000    0.7449    1.0000         0    1.0000    0.1578    1.0000    0.1827    1.0000    0.6379    1.0000    0.6835    1.0000 ...
    0.3142    1.0000    0.5246    1.0000    0.8092    1.0000    0.2308    1.0000    0.2560    1.0000    0.4494    1.0000    0.4298    1.0000 ...
    0.3052    1.0000    0.6733    1.0000    0.1526    1.0000    0.6655    1.0000    0.2853    1.0000    0.8025    1.0000    0.9824    1.0000 ... 
    0.4336    1.0000    0.5033    1.0000    0.8710    1.0000    0.5528    1.0000    0.2100    1.0000    0.1779    1.0000    0.5712    1.0000 ...
    0.1961    1.0000    0.4016    1.0000    0.6798    1.0000    0.9489    1.0000    0.2966    1.0000    0.2573    1.0000    0.5063    1.0000 ...
    0.7193    1.0000         0    1.0000    0.7530    1.0000    0.1931    1.0000    0.7348    1.0000    0.3794    1.0000    0.6138    1.0000 ...
    0.4765    1.0000         0    1.0000    0.6464    1.0000    0.8516    1.0000    0.2133    1.0000         0    1.0000    0.6202    1.0000 ...
         0    1.0000         0    1.0000    0.7854    1.0000    0.1981    1.0000    0.9698    1.0000    0.3916    1.0000    0.2066    1.0000 ...
    0.9233    1.0000    0.2573    1.0000         0    1.0000    0.9014    1.0000         0    1.0000    0.4786    1.0000    0.3803    1.0000 ...
         0    1.0000    0.9914    1.0000    0.3955    1.0000    0.9025    1.0000    0.8623    1.0000    0.5806    1.0000    0.9084    1.0000 ...
    0.7120    1.0000    0.9702    1.0000    0.3505    1.0000    0.3042    1.0000         0    1.0000    0.7269    1.0000    0.4768    1.0000 ...
         0    1.0000         0    1.0000         0    1.0000    0.2366    1.0000    0.5906    1.0000    0.2186    1.0000    0.1667    1.0000 ...
         0    1.0000    0.5487    1.0000    0.3143    1.0000    0.8933    1.0000    0.3708    1.0000    0.8207    1.0000         0    1.0000 ...
    0.3394    1.0000    0.7832    1.0000         0    1.0000    0.2039    1.0000         0    1.0000    0.2201    1.0000    0.3421    1.0000 ...
    0.2090    1.0000    0.4092    1.0000    0.4780    1.0000    0.3270    1.0000    0.7449    1.0000    0.9891    1.0000    0.4961    1.0000 ...
    0.5885    1.0000    0.9963    1.0000         0    1.0000    0.4849    1.0000    0.3418    1.0000    0.6427    1.0000    0.3416    1.0000 ...
    0.4628    1.0000    0.9655    1.0000    0.9558    1.0000    0.3543    1.0000         0    1.0000    0.1651    1.0000    0.9000    1.0000 ...
    0.7986    1.0000    0.4455    1.0000    0.6902    1.0000    0.3392    1.0000    0.5494    1.0000    0.2548    1.0000    0.7113    1.0000 ...
    0.4268    1.0000    0.3265    1.0000    0.2206    1.0000    0.8748    1.0000    0.8666    1.0000    0.3378    1.0000    0.3721    1.0000 ...
    0.2709    1.0000         0    1.0000    0.8441    1.0000    0.7241    1.0000    0.3296    1.0000    0.9843    1.0000    0.7920    1.0000 ...
    0.7516    1.0000         0    1.0000    0.1906    1.0000    0.7255    1.0000    0.6569    1.0000         0    1.0000    0.3859    1.0000 ...
    0.5357    1.0000    0.2033    1.0000         0    1.0000         0    1.0000    0.9355    1.0000    0.5025    1.0000    0.7517    1.0000 ...
    0.5136    1.0000         0    1.0000    0.4001    1.0000    0.6848    1.0000    0.9252    1.0000    0.4844    1.0000    0.3165    1.0000 ...
    0.9349    1.0000    0.9204    1.0000    0.6331    1.0000    0.7154    1.0000    0.9173    1.0000         0    1.0000    0.3704    1.0000 ...
    0.7625    1.0000         0    1.0000    0.8813    1.0000         0    1.0000    0.6866    1.0000    0.2508    1.0000    0.5798    1.0000 ...
    0.2518    1.0000    0.7321    1.0000    0.3371    1.0000    0.4226    1.0000    0.4496    1.0000    0.7166    1.0000    0.3078    1.0000 ...
    0.8303    1.0000    0.5993    1.0000    0.9765    1.0000    0.6883    1.0000    0.7311    1.0000    0.8726    1.0000    0.5661    1.0000 ...
    0.2151    1.0000    0.5764    1.0000         0    1.0000    0.2154    1.0000    0.6080    1.0000         0    1.0000    0.3535    1.0000 ...
    0.2360    1.0000    0.1856    1.0000    0.3800    1.0000    0.1892    1.0000         0    1.0000    0.7030    1.0000    0.9122    1.0000 ...
    0.9956    1.0000    0.9887    1.0000    0.5949    1.0000    0.3444    1.0000    0.6440    1.0000    0.6715    1.0000    0.1550    1.0000 ...
    0.3000    1.0000         0    1.0000    0.4324    1.0000    0.4906    1.0000    0.4077    1.0000    0.1899    1.0000    0.5649    1.0000 ...
    0.2596    1.0000    0.9195    1.0000    0.3835    1.0000    0.5910    1.0000    0.3071    1.0000         0    1.0000    0.8468    1.0000 ...
    0.9179    1.0000    0.5733    1.0000    0.7336    1.0000    0.3065    1.0000    0.8373    1.0000         0    1.0000    0.8736    1.0000 ...
    0.3972    1.0000    0.7681    1.0000    0.6517    1.0000    0.7380    1.0000    0.2923    1.0000    0.4372    1.0000    0.9291    1.0000 ...
    0.3065    1.0000    0.9632    1.0000    0.9775    1.0000    0.7313    1.0000    0.2488    1.0000    0.8383    1.0000    0.2954    1.0000 ...
    0.3486    1.0000    0.5527    1.0000    0.9001    1.0000    0.2134    1.0000    0.1595    1.0000    0.5303    1.0000    0.6993    1.0000 ...
    0.6508    1.0000    0.5869    1.0000    0.9276    1.0000    0.7130    1.0000    0.5294    1.0000    0.7840    1.0000    0.2407    1.0000 ...
    0.8781    1.0000    0.9662    1.0000    0.6069    1.0000    0.7413    1.0000    0.7156    1.0000    0.9490    1.0000         0    1.0000 ...
    0.9194    1.0000    0.5185    1.0000    0.7559    1.0000    0.3153    1.0000    0.9487    1.0000    0.9052    1.0000    0.4942    1.0000 ...
    0.3717    1.0000    0.2117    1.0000    0.4438    1.0000    0.6470    1.0000    0.5509    1.0000    0.7914    1.0000    0.5354    1.0000 ...
    0.4436    1.0000    0.7301    1.0000    0.5319    1.0000    0.4349    1.0000    0.6469    1.0000    0.5028    1.0000         0    1.0000 ...
    0.3913    1.0000    0.8688    1.0000    0.7084    1.0000    0.5875    1.0000    0.9936    1.0000    0.6054    1.0000    0.6180    1.0000 ...
    0.1911    1.0000    0.8105    1.0000         0    1.0000    0.3765    1.0000    0.9374    1.0000    0.5298    1.0000    0.4157    1.0000 ...
    0.7378    1.0000    0.6982    1.0000         0    1.0000    0.2262    1.0000    0.1654    1.0000    0.2822    1.0000    0.3632    1.0000 ...
         0    1.0000    0.3500    1.0000         0    1.0000    0.7146    1.0000         0    1.0000         0    1.0000    0.9786    1.0000 ...
    0.4482    1.0000    0.5850    1.0000         0    1.0000    0.4580    1.0000    0.4114    1.0000    0.4428    1.0000    0.4569    1.0000 ...
    0.8398    1.0000    0.6011    1.0000         0    1.0000    0.9694    1.0000    0.8529    1.0000         0    1.0000    0.8386    1.0000 ...
    0.7231    1.0000    0.9038    1.0000    0.6296    1.0000    0.6872    1.0000         0    1.0000    0.6227    1.0000    0.7415    1.0000 ...
    0.2257    1.0000    0.2864    1.0000    0.6591    1.0000         0    1.0000    0.3631    1.0000    0.7935    1.0000    0.7961    1.0000 ...
    0.4337    1.0000         0    1.0000    0.8521    1.0000         0    1.0000    0.6292    1.0000    0.5750    1.0000    0.1886    1.0000 ...
    0.7689    1.0000         0    1.0000    0.4907    1.0000    0.6409    1.0000    0.9726    1.0000    1.0000    0.9702    1.0000    0.8339 ...
    1.0000         0    1.0000    0.2417    1.0000    0.3697    1.0000    0.5599    1.0000    0.8866    1.0000    0.9275    1.0000    0.3055 ...
    1.0000         0    1.0000         0    1.0000    0.9566    1.0000    0.6832    1.0000    0.2110    1.0000    0.9725    1.0000    0.7250 ...
    1.0000    0.4387    1.0000         0    1.0000    0.7233    1.0000    0.5740    1.0000    0.9791    1.0000    0.4322    1.0000    0.8068 ...
    1.0000    0.3422    1.0000    0.2490    1.0000    0.8504    1.0000         0    1.0000    0.6331    1.0000         0    1.0000    0.6235 ...
    1.0000    0.8341    1.0000         0    1.0000         0    1.0000    0.4004    1.0000    0.5063    1.0000    0.9915    1.0000    0.7911 ...
    1.0000    0.9214    1.0000    0.1978    1.0000    0.9428    1.0000    0.2472    1.0000    0.9663    1.0000    0.3807    1.0000    0.4857 ...
    1.0000    0.2735    1.0000         0    1.0000    0.8513    1.0000    0.6973    1.0000         0    1.0000    0.5132    1.0000    0.7982 ...
    1.0000    0.2186    1.0000    0.2104    1.0000    0.1936    1.0000    0.4706    1.0000    0.4126    1.0000    0.2769    1.0000    0.4086 ...
    1.0000    0.5745    1.0000    0.6464    1.0000    0.1673    1.0000         0    1.0000    0.2604    1.0000    0.6331    1.0000    0.2689 ...
    1.0000    0.3633    1.0000    0.6843    1.0000    0.7291    1.0000    0.3756    1.0000         0    1.0000    0.8680    1.0000    0.4111 ...
    1.0000    0.9353    1.0000    0.3265    1.0000    0.2480    1.0000    0.6131    1.0000    0.9354    1.0000    0.3423    1.0000    0.5912 ...
    1.0000    0.3118    1.0000    0.1513    1.0000    0.9941    1.0000    0.6934    1.0000    0.6260    1.0000    0.4898    1.0000    0.5714 ...
    1.0000    0.7960    1.0000    0.5902    1.0000    0.3576    1.0000    0.7668    1.0000    0.4252    1.0000    0.5971    1.0000    0.8894 ...
    1.0000    0.1982    1.0000    0.7633    1.0000    0.7424    1.0000    0.3257    1.0000    0.4912    1.0000    0.4714    1.0000    0.1775 ...
    1.0000    0.9531    1.0000    0.2480    1.0000         0    1.0000    0.3275    1.0000    0.7220    1.0000         0    1.0000    0.7303 ...
    1.0000    0.7186    1.0000    0.3969    1.0000    0.3241    1.0000    0.3121    1.0000    0.2272    1.0000    0.8840    1.0000         0 ...
    1.0000    0.8176    1.0000    0.7060    1.0000    0.2008    1.0000    0.8502    1.0000    0.3206    1.0000    0.3839    1.0000    0.2773 ...
    1.0000         0    1.0000    0.7056    1.0000    0.2894    1.0000    0.2814    1.0000         0    1.0000         0    1.0000    0.7718 ...
    1.0000    0.9731    1.0000         0    1.0000    0.7564    1.0000    0.8251    1.0000    0.9976    1.0000    0.2066    1.0000    0.3905 ...
    1.0000    0.2101    1.0000    0.9110    1.0000    0.6734    1.0000    0.6304    1.0000    0.2143    1.0000         0    1.0000         0 ...
    1.0000    0.5541    1.0000    0.5163    1.0000    0.2474    1.0000    0.5355    1.0000    0.1733    1.0000    0.2609    1.0000    0.3069 ...
    1.0000    0.6145    1.0000    0.5288    1.0000    0.7923    1.0000    0.5130    1.0000    0.6379    1.0000    0.6499    1.0000    0.5090 ...
    1.0000    0.9475    1.0000    0.3307    1.0000    0.9599    1.0000         0    1.0000         0    1.0000    0.9416    1.0000    0.8017 ...
    1.0000    0.6692    1.0000    0.8759    1.0000         0    1.0000    0.6905    1.0000    0.6055    1.0000    0.3681    1.0000         0 ...
    1.0000    0.9365    1.0000    0.2982    1.0000    0.7059    1.0000    0.7391    1.0000    0.8584    1.0000    0.8585    1.0000    0.4004 ...
    1.0000    0.3511    1.0000    0.7516    1.0000    0.7833    1.0000         0    1.0000         0    1.0000    0.5653    1.0000    0.3284 ...
    1.0000    0.9746    1.0000    0.5341    1.0000    0.4310    1.0000    0.6387    1.0000    0.4821    1.0000    0.7483    1.0000    0.9728 ...
    1.0000    0.3547    1.0000    0.7993    1.0000    0.5048    1.0000    0.5873    1.0000    0.3107    1.0000    0.5071    1.0000    0.8183 ...
    1.0000    0.3781    1.0000    0.3675    1.0000         0    1.0000         0    1.0000    0.7237    1.0000    0.5551    1.0000    0.7921 ...
    1.0000    0.8338    1.0000    0.4884    1.0000    0.6996    1.0000    0.4397    1.0000    0.5624    1.0000         0    1.0000    0.5949 ...
    1.0000    0.3072    1.0000         0    1.0000         0    1.0000    0.6634    1.0000         0    1.0000    0.7720    1.0000    0.6327 ...
    1.0000         0    1.0000    0.2936    1.0000    0.1673    1.0000    0.4714    1.0000    0.4873    1.0000    0.7508    1.0000    0.2559 ...
    1.0000    0.5793    1.0000    0.7143    1.0000    0.9484    1.0000    0.9256    1.0000    0.4562    1.0000    0.5975    1.0000    0.4053 ...
    1.0000    0.9502    1.0000    0.5192    1.0000    0.1806    1.0000    0.9743    1.0000    0.8407    1.0000    0.7381    1.0000    0.5887 ...
    1.0000         0    1.0000    0.7215    1.0000    0.1554    1.0000    0.6624    1.0000    0.7690    1.0000    0.5679    1.0000    0.4475 ...
    1.0000    0.9108    1.0000    0.6467    1.0000    0.2127    1.0000    0.2867    1.0000    0.3509    1.0000    0.6224    1.0000    0.9644 ...
    1.0000    0.6980    1.0000    0.3909    1.0000    0.4497    1.0000    0.4118    1.0000    0.1545    1.0000    0.1899    1.0000    0.8627 ...
    1.0000    0.2725    1.0000    0.7200    1.0000    0.4792    1.0000    0.8451    1.0000         0    1.0000    0.2395    1.0000    0.3888 ...
    1.0000    0.8302    1.0000    0.9968    1.0000    0.3411    1.0000    0.9035    1.0000    0.9539    1.0000    0.7013    1.0000    0.9898 ...
    1.0000    0.2701    1.0000         0    1.0000    0.9936    1.0000    0.3099    1.0000    0.6613    1.0000    0.9702    1.0000    0.8990 ...
    1.0000         0    1.0000    0.2133    1.0000    0.6278    1.0000    0.4667    1.0000         0    1.0000    0.6883    1.0000         0 ...
    1.0000    0.2148    1.0000    0.4677    1.0000    0.9626    1.0000    0.2352    1.0000         0    1.0000    0.8361    1.0000    0.2430 ...
    1.0000    0.8172    1.0000    0.8362    1.0000    0.2242    1.0000    0.9210    1.0000    0.8506    1.0000         0    1.0000         0 ...
    1.0000    0.8700    1.0000    0.8289    1.0000    0.8584    1.0000    0.9649    1.0000    0.5755    1.0000    0.9780    1.0000    0.6781 ...
    1.0000    0.6459    1.0000    0.7759    1.0000    0.6130    1.0000    0.6249    1.0000         0    1.0000    0.1771    1.0000         0 ...
    1.0000    0.6405    1.0000    0.6652    1.0000    0.8332    1.0000    0.5226    1.0000    0.1725    1.0000    0.3929    1.0000    0.2517 ...
    1.0000    0.4045    1.0000    0.2113    1.0000    0.9548    1.0000         0    1.0000    0.5269    1.0000    0.5349    1.0000    0.4992 ...
    1.0000    0.4197    1.0000         0    1.0000    0.6092    1.0000         0    1.0000    0.1822    1.0000    0.4984    1.0000    0.9659 ...
    1.0000         0    1.0000    0.4808    1.0000    0.1779    1.0000    0.3830    1.0000    0.7127    1.0000    0.7266    1.0000    0.9183 ...
    1.0000    0.6636    1.0000    0.3472    1.0000    0.1680    1.0000         0    1.0000    0.3687    1.0000    0.5279    1.0000    0.4069 ...
    1.0000    0.6091    1.0000    0.8411    1.0000    0.4361    1.0000    0.6989    1.0000    0.8488    1.0000    0.9101    1.0000    0.1746 ...
    1.0000    0.2517    1.0000    0.8336    1.0000         0    1.0000    0.6796    1.0000         0    1.0000    0.3311    1.0000    0.2425 ...
    1.0000    0.2825    1.0000    0.7778    1.0000    0.6421    1.0000    0.3935    1.0000    0.2306    1.0000    0.9528    1.0000    0.9071 ...
    1.0000    0.6567    1.0000    0.9683    1.0000    0.5980    1.0000    0.3533    1.0000    0.5468    1.0000    0.4539    1.0000         0 ...
    1.0000    0.6560    1.0000    0.4978    1.0000         0    1.0000    0.6183    1.0000    0.3510    1.0000    0.7283    1.0000    0.5129 ...
    1.0000    0.9270    1.0000    0.8672    1.0000    0.6762    1.0000    0.7987    1.0000    0.5928    1.0000    0.5046    1.0000    0.9520 ...
    1.0000    0.3547    1.0000    0.2034    1.0000    0.2949    1.0000    0.9681    1.0000    0.2778    1.0000         0    1.0000    0.2786 ...
    1.0000    0.9897    1.0000    0.5663    1.0000    0.2516    1.0000    0.7943    1.0000    0.8085    1.0000    0.9540    1.0000    0.7640 ...
    1.0000    0.8116    1.0000    0.8071    1.0000    0.6451    1.0000    0.5179    1.0000    0.3496    1.0000    0.1598    1.0000    0.4199 ...
    1.0000         0    1.0000    0.7489    1.0000    0.8051    1.0000    0.1816    1.0000    0.4887    1.0000    0.7369    1.0000    0.6473 ...
    1.0000    0.9976    1.0000    0.6153    1.0000    0.6287    1.0000    0.9872    1.0000    0.4521    1.0000    0.5432    1.0000    0.9985 ...
    1.0000    0.3010    1.0000    0.9256    1.0000    0.7201    0.6486    0.6643    0.9076         0    0.4684    0.2051    0.8929    0.7959 ...
    0.9562    0.1617    0.7500    0.5010    0.2460         0    0.1851    0.7148    0.7578         0         0    0.8546    0.4348    0.5655 ...
    0.1817    0.4082    0.5852    0.6257    0.1642    0.8792         0         0         0         0         0    0.3969    0.3246    0.7492 ...
    0.4355         0    0.4121    0.7691         0    0.9159         0         0         0    0.2171    0.9889    0.4500    0.3679    0.9097 ...
    0.9103    0.2414    0.2617    0.5252         0         0    0.8970    0.2431    0.5670    0.3802    0.1679    0.4651    0.1681    0.9542 ...
    0.2311    0.7037    0.4763    0.9354    0.9791         0    0.8073    0.3201         0    0.5785    0.5634    0.4109    0.3974    0.7845 ...
    0.1998    0.7474         0    0.9881    0.7360    0.3411    0.8629    0.9585    0.9782         0    0.9164    0.2713    0.3744    0.3753 ...
    0.6089    0.5915    0.8274    0.2896    0.8353         0    0.3118         0    0.3511    0.6641         0         0    0.5275    0.4236 ...
         0    0.3175    0.9719    0.9823    0.7853    0.2183    0.4950    0.5503    0.6932    0.1530    0.9665         0    0.6294    0.5222 ...
    0.2092    0.6983    0.7811    0.4624    0.3608    0.8138    0.6740    0.8465    0.7783    0.1641    0.8801    0.5701    0.7852    0.9496 ...
    0.4533    0.5812    0.7984    0.6590    0.9255    0.4649         0    0.1749    0.7663         0    0.4979    0.1952    0.5855    0.3023 ...
    0.8805         0    0.4469         0    0.3358    0.3695    0.6777         0    0.3969    0.4862         0    0.5209    0.6131    0.9598 ...
    0.7471    0.4745    0.6572    0.6908    0.1540         0    0.2082    0.5878    0.8567    0.4145    0.7663         0    0.1926    0.9963 ...
    0.8884    0.3871    0.2109    0.7425    0.9170    0.3941    0.8295    0.7158    0.4660         0    0.4707    0.6385    0.7085    0.8857 ...
    0.9213    0.5703    0.4144         0    0.6205    0.9375    0.4230         0         0    0.9348    0.9227    0.4064         0         0 ...
         0    0.7874         0    0.7740    0.7012    0.3650    0.1629    0.6936    0.8042    0.5012    0.2925         0    0.4346         0 ...
    0.3903    0.7115    0.5436    0.4036    0.4226    0.2777    0.6265    0.6604    0.2942    0.2107         0    0.1808    0.3399    0.5559 ...
    0.6725    0.2995    0.3176    0.3093    0.4304    0.5135    0.5206    0.2773         0    0.5451    0.4334    0.3673    0.6131    0.5690 ...
    0.7380    0.3970    0.6454    0.3446    0.9065    0.6746    0.2046    0.3737    0.1922    0.4918    0.6967    0.9170    0.7758    0.7807 ...
    0.6479         0    0.2407    0.2022    0.4789    0.3130    0.5141    0.2200    0.9093    0.4030    0.7820    0.7286    0.8729    0.7340 ...
    0.8498    0.3917    0.7231    0.6499    0.1582         0    0.4659    0.1624    0.3376    0.4635    0.8124    0.6200    0.1693    0.7251 ...
    0.8088    0.8313    0.7807    0.5751         0    0.4429         0    0.2611    0.9640    0.1692    0.4003         0    0.2246    0.6707 ...
    0.8337    0.7900         0    0.3658         0    0.6441    0.4354    0.6912    0.1765         0    0.4045    0.7158    0.7165    0.6394 ... 
    0.4688    0.3273    0.4006    0.9883         0    0.5212    0.7288    0.3639    0.3043    0.4846    0.9874    0.9013    0.4853    0.6184 ...
    0.5225    0.7404    0.9114    0.7675    0.8342    0.8841    0.4964         0    0.9464    0.4450    0.5789    0.7110    0.7049    0.4369 ...
    0.3731    0.3783    0.5178    0.5474    0.8529    0.4980    0.4327    0.8976    0.2922    0.7896    0.8048         0    0.5551    0.5900 ...
    0.9667    0.1903         0    0.9449    0.7551    0.3247    0.3777    0.5802    0.6138    0.2618         0    0.5401    0.4834    0.8915 ...
    0.7391    0.9557    0.6402    0.6720    0.6537    0.4289    0.8102         0    0.4347    0.9240    0.4849         0         0         0 ...
    0.3187    0.7917    0.1555    0.5957    0.3036    0.7196    0.2628    0.1918    0.5214         0         0    0.7126    0.8995         0 ... 
    0.2454    0.2217    0.8978    0.8126         0    0.4595    0.8540    0.6328         0    0.3253    0.6845         0         0    0.5944 ...
    0.9920    0.8059    0.2795         0    0.9621         0    0.7524    0.2782    0.5672    0.5925    0.3802    0.1881    0.8816    0.9882 ...
         0    0.3976         0    0.1813    0.9993    0.5337    0.8372    0.7950    0.1814    0.5618    0.7771    0.9149    0.4937    0.2613 ...
    0.2136    0.7946    0.9831    0.7193    0.5427    0.6533    0.6262         0         0         0         0    0.3048    0.6827    0.9086 ...
    0.2386    0.5540    0.2789    0.1910    0.2276    0.4582    0.4848    0.5219    0.3892    0.6881    0.7150    0.3059    0.9203    0.4402 ...
    0.7274    0.6182    0.7776    0.8411    0.5466         0    0.4740    0.7272    0.6716    0.4230    0.4879    0.8947    0.7675    0.3593 ...
    0.5774    0.2613    0.3649    0.7850         0    0.3110         0    0.9138    0.7621    0.6539    0.4316    0.3735    0.7377    0.5268 ...
    0.9531    0.3299    0.4584    0.8316    0.7160    0.5392    0.2026    0.6681         0         0    0.9432    0.9496    0.8787    0.4799 ...
         0    0.4446    0.5092    0.4457    0.5012    0.6889    0.1618    0.3955    0.9560    0.3746         0    0.9374    0.3244    0.7587 ...
    0.5626         0    0.1625    0.8692    0.8384         0    0.9335    0.3521         0    0.1851    0.7869         0    0.1936         0 ...
    0.8398    0.9686    0.1784    0.2038         0         0    0.7043    0.3660    0.3247    0.5735    0.3333    0.9204         0    0.3108 ...
    0.2119         0    0.2244    0.4452    0.6025    0.2865         0    0.7351    0.1595    0.7787    0.2177    0.2167         0    0.3199 ...
    0.4043         0    0.8574    0.3995         0    0.2058    0.6931    0.6265    0.1936    0.7056    0.6247         0    0.9028    0.5218 ...
    0.5349    0.2068    0.5741    0.3829    0.2615    0.8820    0.4767    0.8390    0.8662    0.9972    0.7753    0.7392    0.3935    0.9784 ...
    0.9109    0.6081    0.2307    0.9841    0.2335    0.5872    0.5792    0.5587    0.7722    0.3296    0.1525    0.7697    0.7723    0.4767 ...
    0.7796    0.6995    0.5972    0.2946    0.2963    0.2512    0.2763    0.5901    0.1693    0.1737    0.9939         0         0    0.3846 ...
    0.6125         0    0.8620    0.2333    0.5795    0.9963    0.3739         0    0.4001    0.7282         0    0.9724    0.6985    0.1655 ...
    0.9325    0.4300    0.1599    0.5837         0    0.6044    0.5144    0.6425    0.6592    0.5712    0.3013         0    0.4920    0.3423 ...
         0    0.9201    0.9107    0.4501    0.5410    0.4212    0.9205    0.3479    0.7749    0.6027    0.9151    0.5197    0.7255         0 ...
    0.7399    0.1558    0.2668    0.2247    0.5009    0.8486    0.5862         0    0.8138    0.3609    0.7825    0.6849    0.1892    0.2049 ...
    0.2760    0.2721    0.4735    0.8513    0.4497    0.4573    0.9455    0.5277    0.6024         0    0.2620    0.2841         0    0.7051 ...
    0.1705    0.3329    0.2382    0.4682    0.7954    0.2325    0.9541         0    0.8852    0.7584    0.2407    0.7942         0    0.1956 ...
    0.7427         0    0.4385    0.6498    0.3573    0.8470    0.5362    0.8355         0    0.3525    0.8168         0    0.2349    0.8332 ...
    0.5992    0.7513    0.8874    0.7545    0.9977         0    0.8270    0.2920    0.2718    0.7810    0.9507    0.8138    0.7188    0.7383 ...
    0.8529    0.3870    0.8601    0.8369    0.4348    0.9640    0.7210    0.7224    0.2873    0.6336    0.9221    0.3125         0    0.5317 ...
    0.3932    0.6289    0.5548    0.5547    0.9896    0.9239    0.7048    0.5172    0.7501    0.6519    0.2962    0.8022    0.9172    0.9483 ...
    0.4016    0.7487    0.9916    0.4876    0.3177         0    0.2096    0.4538    0.4505    0.1999    0.3514    0.6398    0.8774    0.3407 ... 
    0.1741    0.6692    0.5748    0.8148    0.3023    0.4151    0.6966    0.2730    0.6552    0.4901    0.9504    0.8359    0.3251    0.3810 ... 
    0.7168    0.6344         0    0.5937    0.7812    0.4520    0.2855         0    0.6042         0    0.7957    0.4668    0.2759    0.9822 ...
    0.2690    0.4334    0.2107    0.5573         0    0.4113    0.3044    0.4412         0    0.9013    0.9508         0    0.5111    0.8688 ...
    0.2523    0.9786    0.1573    0.9818         0    0.6551    0.6947    0.9084    0.8936    0.5795    0.3790    0.1810    0.6012    0.8326 ...
    0.9424    0.4272    0.1930    0.5676    0.8162    0.8944    0.4328    0.9109    0.9317    0.3453    0.7325    0.5645    0.1662         0 ...
    0.3556    0.7930         0    0.6459    0.4305    0.9149         0    0.7383         0         0         0         0    0.5692    0.7514 ...
    0.7949    0.3979]);

pnet.CPD{18} = tabular_CPD(pnet, 18,[  0.5391    1.0000    0.8760    1.0000    0.2708    1.0000    0.8480    1.0000    0.3102    1.0000    0.6404    1.0000    0.8728    1.0000    0    1.0000    0.9036    1.0000    1.0000    0.1695    1.0000    0.8955    1.0000         0    1.0000    0.2584    1.0000         0    1.0000    0.4286    1.0000    0.8704    1.0000    0.9462    1.0000    0.5864]);
pnet.CPD{19} = tabular_CPD(pnet, 19,[
        0    1.0000    0.9581    1.0000    0.6430    1.0000    0.5727    1.0000    0.3196    1.0000    0.7109    1.0000    0.3955    1.0000 ...
   0.6600    1.0000         0    1.0000    0.3462    1.0000         0    1.0000    0.1741    1.0000    0.3621    1.0000         0    1.0000 ...
        0    1.0000         0    1.0000    0.6355    1.0000    0.1858    1.0000    1.0000    0.2591    1.0000    0.2950    1.0000    0.7539 ...
   1.0000    0.6101    1.0000    0.6165    1.0000    0.9188    1.0000         0    1.0000    0.5260    1.0000    0.6453    1.0000    0.3935 ...
   1.0000    0.9972    1.0000    0.8243    1.0000    0.7263    1.0000         0    1.0000    0.6811    1.0000    0.9920    1.0000         0 ...
   1.0000    0.3387    0.6118         0    0.7446         0    0.1852    0.2402    0.6749         0    0.3613    0.3917    0.9376    0.4681 ...
   0.6531    0.7659    0.5942    0.8995    0.2762         0    0.4946    0.9189    0.6275    0.7983    0.2475    0.2876    0.7816    0.7237 ...
   0.9296    0.4445    0.2683    0.8728    0.3849    0.6876    0.3485    0.2802         0    0.8976]); 
pnet.CPD{20} = tabular_CPD(pnet, 20,[0.2771 1 0.2209 1 0.4792 1 1 0.2662 1 0.9395 1 0.3237]);
pnet.CPD{21} = tabular_CPD(pnet, 21,[0.4251 1 1 0.5564 0.8323 0]);
pnet.CPD{22} = tabular_CPD(pnet, 22,[0 1 1 0.3334]);
pnet.CPD{23} = tabular_CPD(pnet, 23,[0.2685 1 1 0.2553 0 0.4778]);
pnet.CPD{24} = tabular_CPD(pnet, 24,[0 1 0.6112 1 0.9176 1]);
pnet.CPD{25} = tabular_CPD(pnet, 25,[0.6974 1 0.2332 1 0.5085 1 0.9526 0.1787 0.9225]);
pnet.CPD{26} = tabular_CPD(pnet, 26,[0 1 0.9104 1 0.9519 1 1 0.6232 1 0.1870 1 0.7117]);
pnet.CPD{27} = tabular_CPD(pnet, 27,[0 1 0.1955 1 0 1 1 0 1 0.7607 1 0.7294 0.4504 0.7366 0.2070 0 0.4075 0.7738]);
pnet.CPD{28} = tabular_CPD(pnet, 28,[0.8137 1 0.6766 1 0.6284 1 1 0.2800 1 0 1 0.8049]);
pnet.CPD{29} = tabular_CPD(pnet, 29,[0.7209 1 1 0.1715 0.7280 0]);
pnet.CPD{30} = tabular_CPD(pnet, 30,[0.1891 1 0.9304 1 0 1 1 0.6816 1 0.2081 1 0.2287]);

evidence = cell(1,N);

evidence{28} = 1;  
evidence{30} = 2;  

var_interest= 15;




disp('----------------classique jtree min-------------');
engine = jtree_inf_engine(pnet);
tic; [engine] = global_propagation(engine, evidence); toc;

marg = marginal_nodes(engine, var_interest);
BEL_Cdt_classique=marg.T(3)


evidence{15}=3; %au lieu de interest

    
disp('----------------stab-------------');
engine = MG_inf_engine(pnet);
tic; [Bel_Cdt_new, best_instances, cap_max,nb_add] = global_propagation(engine,  [], evidence ,0, 1, 'neighbors'); t1=toc;
%temps_add{nb_example}=t1
Bel_Cdt_add=Bel_Cdt_new
cap_max
if cap_max==1
 cap_max_add=cap_max_add+1
end
   
disp('----------------consistency 2-------------');
engine = MG_inf_engine(pnet);
tic; [Bel_Cdt_new, best_instances, cap_max] = global_propagation(engine, [], evidence ,2, 1, 'neighbors'); t1=toc;
%temps_best{nb_example}=t1
Bel_Cdt_best=Bel_Cdt_new
if cap_max==1
 cap_max_best=cap_max_best+1
end


