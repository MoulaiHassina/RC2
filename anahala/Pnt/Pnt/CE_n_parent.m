N = 40;

     nodes= [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31    32    33    34    35    36    37    38    39    40];

node_sizes= [3 2 3 2 3 2 3 2 3 2  3  2  3  2  3  2  3  2  3  2  3  2  3  2  3  2  3  2  3  2 3     2     3     2     3     2     3     2     3     2];

dag=zeros(N,N);

dag=[
 0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	1	1	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	;
0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	1	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	1	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	1	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	1	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	1	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	1	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	1	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	1	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	1	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	1	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	;
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0		];
 
pnet = mk_pnet(dag, node_sizes, nodes);

pnet.CPD{1} = tabular_CPD(pnet, 1,[ 1.0000    0.7359    0.5147]); 
pnet.CPD{2} = tabular_CPD(pnet, 2,[ 1     0]); 
pnet.CPD{3} = tabular_CPD(pnet, 3,[1.0000    0.4740    0.7021]); 
pnet.CPD{4} = tabular_CPD(pnet, 4,[  1     0]); 
pnet.CPD{5} = tabular_CPD(pnet, 5,[ 0.1857    1.0000    1.0000    0.7539    0.8767    0.6451]); 
pnet.CPD{6} = tabular_CPD(pnet, 6,[0    1.0000         0    1.0000    0.6401    1.0000    0.8378    1.0000    0.6465    1.0000    0.5220    1.0000    0.8234    1.0000  0.4170    1.0000         0    1.0000    0.4047    1.0000    0.7454    1.0000    0.8545    1.0000    0.5076    1.0000    0.6268    1.0000  0    1.0000    0.3338    1.0000    0.3407    1.0000         0    1.0000    1.0000    0.6189    1.0000    0.8631    1.0000    0.9524  1.0000    0.2298    1.0000    0.9117    1.0000    0.2205    1.0000    0.9247    1.0000    0.8128    1.0000    0.5766    1.0000         0  1.0000    0.4071    1.0000    0.7640    1.0000    0.5029    1.0000    0.9485    1.0000    0.6827    1.0000    0.1618    1.0000    0.3917  1.0000    0.6034]); 
pnet.CPD{7} = tabular_CPD(pnet, 7,[0    1.0000    0.4308    1.0000         0    1.0000    0.4731    1.0000    0.9949    1.0000    0.9592    1.0000    0.6236    1.0000    0.7728    1.0000    0.4338    1.0000    0.9825    1.0000    0.2819    1.0000    0.5500    1.0000    0.4764    1.0000         0    1.0000   0.6543    1.0000    0.6468    1.0000         0    1.0000         0    1.0000    1.0000    0.5857    1.0000    0.5359    1.0000    0.2507    1.0000    0.3505    1.0000    0.4270    1.0000    0.4557    1.0000    0.3737    1.0000    0.4969    1.0000    0.4376    1.0000    0.5565    1.0000    0.6416    1.0000    0.4232    1.0000    0.4700    1.0000    0.9328    1.0000    0.8281    1.0000    0.4247    1.0000    0.8040    1.0000    0.9579    0.1711    0.5260    0.8886         0    0.2226    0.9557    0.3624    0.9240    0.8803         0    0.6740    0.4871    0.6772         0    0.3160    0.4292    0.6118    0.4454    0.5259    0.3019         0    0.3776    0.3195    0.4979         0    0.8736    0.2654    0.4102         0    0.8558    0.8200    0.2505    0.3826    0.9661    0.3415    0.6517]); 
pnet.CPD{8} = tabular_CPD(pnet, 8,[0.5920    1.0000    0.7008    1.0000         0    1.0000    1.0000    0.3114    1.0000         0    1.0000    0.8999]); 
pnet.CPD{9} = tabular_CPD(pnet, 9,[0.6816    1.0000    0.4458    1.0000    0.7054    1.0000    1.0000         0    1.0000    0.4795    1.0000    0.4059    0.7251    0.7356   0.8897    0.5473    0.9399         0]);
pnet.CPD{10} = tabular_CPD(pnet, 10,[0.7065    1.0000    0.5751    1.0000    0.3220    1.0000    0.4894    1.0000    0.9462    1.0000    0.7122    1.0000    1.0000    0.8372    1.0000    0.8919    1.0000    0.4953    1.0000    0.5391    1.0000    0.4551    1.0000    0.7788]); 

pnet.CPD{11} = tabular_CPD(pnet, 11,[       
    0.4343    1.0000    0.6473    1.0000    0.7087    1.0000   0.4664    1.0000    0.7699    1.0000    0.4522   1.0000    0.4043   0 1.00000 ... 
    1.0000    0.3253   1.0000   1.0000    0.3760    1.0000    0.9753    1.0000    0.2978    1.0000         0    1.0000    0.9788    1.0000 ...
    0.2367    1.0000    0.4248    1.0000    0.4443   1.0000    0.2967         0    0.8468    0.4895    0.7767   0.2585    0         0.9602... 
    0         0.4984   0.6248    0.5143    0.7825    0.3808    0.3548    0.5097    0.3282   0.3379    0.8754     ] ); 

pnet.CPD{12} = tabular_CPD(pnet, 12,[0.6994    1.0000         0    1.0000         0    1.0000]); 
pnet.CPD{13} = tabular_CPD(pnet, 13,[0.8897    1.0000    1.0000    0.3828    0.8847    0.7375]);
pnet.CPD{14} = tabular_CPD(pnet, 14,[  0.3409    1.0000    1.0000    0.5873]); 
pnet.CPD{15} = tabular_CPD(pnet, 15,[    0         1.0000         0    1.0000    0.6620    1.0000    0.3112    1.0000    0.9502    1.0000    0.2304    1.0000    0.8954    1.0000 ...
    0.4103    1.0000         0    1.0000    0.5838    1.0000    0.6575    1.0000    0.7248    1.0000    0.4849    1.0000    0.9374    1.0000 ...
    0.8866    1.0000    0.9542    1.0000    0.7997    1.0000         0    1.0000    0.7445    1.0000    0.7148    1.0000    0.2550    1.0000 ...
    0.2085    1.0000    0.9117    1.0000    0.8953    1.0000    0.3180    1.0000    0.3300    1.0000         0    1.0000    0.5865    1.0000 ...
    0.8566    1.0000    0.3945    1.0000    0.4975    1.0000         0    1.0000         0    1.0000    0.9443    1.0000         0    1.0000 ...
    0.5787    1.0000    0.4148    1.0000    0.3790    1.0000    0.6958    1.0000    0.7622    1.0000    0.1717    1.0000    0.2036    1.0000 ... 
         0    1.0000         0    1.0000    0.6762    1.0000         0    1.0000    0.1921    1.0000    0.7449    1.0000         0    1.0000 ... 
    0.3050    1.0000    0.3476    1.0000    0.4367    1.0000    0.9476    1.0000    0.4961    1.0000    1.0000    0.9007    1.0000    0.7227 ...
    1.0000         0    1.0000    0.5065    1.0000    0.7478    1.0000    0.4448    1.0000         0    1.0000    0.8209    1.0000    0.8298 ... 
    1.0000    0.2690    1.0000    0.4696    1.0000    0.5600    1.0000    0.9318    1.0000    0.6207    1.0000         0    1.0000         0 ...
    1.0000    0.8624    1.0000    0.9693    1.0000    0.6391    1.0000    0.7788    1.0000    0.2696    1.0000    0.5106    1.0000    0.2173 ...
    1.0000    0.6757    1.0000    0.5006    1.0000    0.8997    1.0000    0.4432    1.0000    0.5393    1.0000    0.1871    1.0000    0.1977 ...
    1.0000    0.7537    1.0000    0.6037    1.0000    0.5816    1.0000    0.4381    1.0000    0.6644    1.0000    0.6155    1.0000    0.1925 ...
    1.0000    0.9962    1.0000    0.4244    1.0000    0.2737    1.0000         0    1.0000    0.5563    1.0000    0.9011    1.0000    0.9603 ...
    1.0000    0.3380    1.0000         0    1.0000    0.3206    1.0000         0    1.0000    0.6929    1.0000    0.9272    1.0000    0.9722 ...
    1.0000    0.6453    1.0000    0.6543    1.0000    0.8522    0.9645    0.4725    0.2213    0.4311         0    0.9874    0.8700    0.8778 ... 
    0.9814    0.2951    0.3130    0.5514    0.4237    0.9069         0    0.7163    0.7276    0.7399    0.5825         0         0    0.7173 ... 
    0.6003    0.5665    0.7807    0.1925    0.3233    0.7276    0.1784    0.5763    0.2896    0.9251    0.4417    0.3254    0.2285    0.5266 ... 
    0.2855    0.7763    0.7691    0.3347    0.9693    0.8895    0.6541    0.4163    0.4838    0.6934         0    0.8341    0.4756    0.5949 ...
    0.2299    0.3217    0.4106    0.4423    0.6854         0    0.6638    0.3852    0.1897    0.5298    0.1895    0.8720    0.4653    0.8311 ...
    0.7125    0.8166    0.5289    0.6054    0.7045    0.4572    0.5224         0    0.8797    0.7611    0.7065    0.4445    0.6797    0.4679 ...
    0.2388         0    0.2737    0.3263    0.7145    0.7655    0.4504    0.2846    0.7339    0.3369    0.4736    0.2242    0.2145    0.3519 ...
    0.9863    0.8321         0    0.9496    0.8314    0.8021    0.7406    0.8936    0.7141    0.8561    0.6999    0.2678    0.3251    0.5492    0.9106         0]);
pnet.CPD{16} = tabular_CPD(pnet, 16,[0.3812    1.0000    0.4245    1.0000    0.1792    1.0000    1.0000    0.1880    1.0000    0.3672    1.0000    0.2691]);
pnet.CPD{17} = tabular_CPD(pnet, 17,[0.9047    1.0000    0.8632    1.0000    0.7031    1.0000    1.0000    0.3713    1.0000    0.9806    1.0000    0.5002    0.6126         0    0.5470    0.2197    0.7353    0.8109]);
pnet.CPD{18} = tabular_CPD(pnet, 18,[0.2646    1.0000    0.8602    1.0000         0    1.0000    0.3156    1.0000    0.3415    1.0000    0.3859    1.0000    0.5303    1.0000         0    1.0000    0.5278    1.0000    1.0000    0.1962    1.0000    0.5595    1.0000    0.3006    1.0000    0.1702    1.0000    0.7804    1.0000    0.3915    1.0000    0.2182    1.0000    0.2550    1.0000    0.7973]);
pnet.CPD{19} = tabular_CPD(pnet, 19,[       0    1.0000    0.6783    1.0000    0.7377    1.0000    0.4688    0.7673    0.1947]); 
pnet.CPD{20} = tabular_CPD(pnet, 20,[ 0.7164    1.0000    0.7308    1.0000         0    1.0000    0.4656    1.0000    0.6070    1.0000    0.2335    1.0000    0.7447    1.0000    0.4298    1.0000    0.2021    1.0000    0.3201    1.0000         0    1.0000    0.4061    1.0000    0.5950    1.0000         0    1.0000    0.2991    1.0000    0.1630    1.0000    0.8274    1.0000    0.8639    1.0000    1.0000    0.5645    1.0000    0.2556    1.0000    0.3521    1.0000    0.6742    1.0000    0.3835    1.0000    0.5342    1.0000    0.4023    1.0000    0.7993    1.0000    0.4781    1.0000         0    1.0000    0.4522    1.0000    0.8512    1.0000    0.9352    1.0000    0.9403    1.0000         0    1.0000    0.1718    1.0000    0.5630    1.0000    0.6088]);
pnet.CPD{21} = tabular_CPD(pnet, 21,[0.6313    1.0000    0.8042    1.0000    0.8265    1.0000    0.5936    1.0000    0.8154    1.0000    0.3443    1.0000    0.4166    1.0000  0.9701    1.0000         0    1.0000    1.0000    0.2894    1.0000    0.3091    1.0000    0.4548    1.0000         0    1.0000    0.6343  1.0000    0.6603    1.0000    0.7650    1.0000    0.5286    1.0000    0.8123    0.7592    0.9427    0.6076    0.6125    0.7445    0.8503  0.8149    0.6687         0    0.2621    0.5518         0    0.3635    0.4295    0.1919         0    0.4057         0]);
pnet.CPD{22} = tabular_CPD(pnet, 22,[ 0    1.0000    0.6675    1.0000    0.9600    1.0000    1.0000    0.9286    1.0000    0.7094    1.0000    0.6813]);
pnet.CPD{23} = tabular_CPD(pnet, 23,[0.8245    1.0000    0.9564    1.0000         0    1.0000    0.2657    1.0000    0.4343    1.0000    0.3506    1.0000    0.3063    1.0000  0.8437    1.0000    0.6458    1.0000    1.0000    0.2386    1.0000    0.6406    1.0000    0.7625    1.0000    0.8110    1.0000    0.3018  1.0000         0    1.0000         0    1.0000    0.1799    1.0000    0.3137    0.5316    0.1798    0.9820         0    0.2633    0.4497  0.3328    0.5429         0    0.8082    0.6115    0.8374    0.8938    0.3415         0    0.2259    0.8878         0]);
pnet.CPD{24} = tabular_CPD(pnet, 24,[0.9419    1.0000         0    1.0000    0.4592    1.0000    1.0000    0.8452    1.0000    0.6451    1.0000    0.2063]);
pnet.CPD{25} = tabular_CPD(pnet, 25,[0.7545    1.0000    0.8111    1.0000    0.6225    1.0000         0    1.0000    0.9498    1.0000         0    1.0000    0.7781    1.0000 ...
  0.8396    1.0000    0.2491    1.0000    0.8485    1.0000         0    1.0000    0.3196    1.0000         0    1.0000    0.5376    1.0000 ...
  0.5775    1.0000    0.6975    1.0000    0.4656    1.0000    0.2542    1.0000    1.0000         0    1.0000    0.4677    1.0000    0.1528 ...
  1.0000    0.9557    1.0000         0    1.0000    0.4579    1.0000    0.7693    1.0000    0.2269    1.0000    0.7751    1.0000    0.6568 ...
  1.0000    0.5201    1.0000    0.6348    1.0000    0.2649    1.0000    0.9255    1.0000         0    1.0000    0.5550    1.0000    0.8124 ...
  1.0000    0.2109    0.3282    0.5887    0.8191    0.3858         0    0.7672    0.4631         0    0.5526         0    0.6466    0.2852 ...
  0.8997    0.8507    0.9183    0.6597    0.5743    0.7451    0.3699    0.4718    0.8135    0.9216    0.9921    0.8522         0    0.4499 ...
  0.5357    0.3918    0.8861    0.4093         0         0         0    0.4115    0.9714    0.5510]);
pnet.CPD{26} = tabular_CPD(pnet, 26,[0.9570    1.0000    0.1679    1.0000         0    1.0000]);
pnet.CPD{27} = tabular_CPD(pnet, 27,[0.2205    1.0000    0.2362    1.0000    0.8629    1.0000    1.0000    0.8163    1.0000    0.4132    1.0000         0    0.6820    0.8248    0.5059    0.7824    0.2710    0.9747]);
pnet.CPD{28} = tabular_CPD(pnet, 28,[0    1.0000    0.7024    1.0000    0.1861    1.0000    0.2690    1.0000         0    1.0000    0.8103    1.0000    0.3600    1.0000 0.7237    1.0000    0.3712    1.0000    0.9107    1.0000    0.1898    1.0000    0.5443    1.0000    0.4719    1.0000    0.1584    1.0000  0.4507    1.0000    0.4103    1.0000    0.2522    1.0000         0    1.0000    1.0000    0.6279    1.0000    0.5031    1.0000    0.3573  1.0000    0.1666    1.0000    0.8171    1.0000    0.2874    1.0000    0.8951    1.0000    0.3986    1.0000    0.2635    1.0000    0.7419  1.0000    0.4056    1.0000         0    1.0000    0.8899    1.0000    0.4891    1.0000    0.5571    1.0000    0.4680    1.0000         0  1.0000    0.9003]);
pnet.CPD{29} = tabular_CPD(pnet, 29,[0    1.0000    0.9219    1.0000    0.6220    1.0000    0.2779    1.0000    0.9897    1.0000    0.2536    1.0000    0.5845    1.0000  0.5069    1.0000    0.9813    1.0000    1.0000    0.3726    1.0000    0.3603    1.0000    0.2285    1.0000    0.2544    1.0000    0.8491  1.0000    0.3913    1.0000    0.5626    1.0000    0.7701    1.0000    0.3574    0.7882    0.7501    0.1562    0.8834    0.5935    0.9155        0    0.7655    0.8157         0    0.9016    0.2536    0.3379    0.6290    0.8431    0.4972    0.3261    0.2122]);
pnet.CPD{30} = tabular_CPD(pnet, 30,[0.3677    1.0000    0.9094    1.0000    0.4123    1.0000    0.9734    1.0000    0.8875    1.0000    0.9416    1.0000    0.6918    1.0000   0.6156    1.0000    0.6857    1.0000    0.9764    1.0000    0.4923    1.0000    0.9736    1.0000    0.3355    1.0000    0.7336    1.0000  0.9364    1.0000    0.2168    1.0000    0.5109    1.0000    0.8188    1.0000    1.0000    0.4389    1.0000    0.4997    1.0000    0.5419  1.0000         0    1.0000         0    1.0000         0    1.0000    0.7645    1.0000    0.7333    1.0000    0.7646    1.0000    0.4553  1.0000    0.6794    1.0000    0.2305    1.0000         0    1.0000    0.3039    1.0000         0    1.0000    0.6283    1.0000         0  1.0000    0.8700]);
pnet.CPD{31} = tabular_CPD(pnet, 31,[ 0.8229    1.0000    1.0000    0.9402    0.2425         0]);
pnet.CPD{32} = tabular_CPD(pnet, 32,[ 0.9248    1.0000    0.1556    1.0000    0.6285    1.0000    1.0000    0.6699    1.0000    0.9390    1.0000    0.3070]);
pnet.CPD{33} = tabular_CPD(pnet, 33,[0.2828    1.0000    0.2149    1.0000    0.8128    1.0000    1.0000    0.8425    1.0000    0.9607    1.0000    0.5067    0.9209    0.6604 0    0.6173         0    0.6377]);
pnet.CPD{34} = tabular_CPD(pnet, 34,[0.9652    1.0000    0.9603    1.0000    0.4417    1.0000    0.5516    1.0000    0.9189    1.0000    0.1683    1.0000    0.4808    1.0000 0    1.0000    0.7829    1.0000    1.0000    0.2672    1.0000    0.3113    1.0000    0.4561    1.0000    0.3086    1.0000    0.3708   1.0000    0.9499    1.0000         0    1.0000    0.3046    1.0000    0.5681]);
pnet.CPD{35} = tabular_CPD(pnet, 35,[ 0.2685    1.0000    0.9528    1.0000         0    1.0000    1.0000    0.2905    1.0000    0.2861    1.0000    0.7200         0    0.6766 0.8338    0.4953    0.8432    0.4137]);
pnet.CPD{36} = tabular_CPD(pnet, 36,[ 0.5918    1.0000         0    1.0000    0.9213    1.0000    1.0000    0.5904    1.0000    0.9239    1.0000    0.2631]);
pnet.CPD{37} = tabular_CPD(pnet, 37,[  0.9246    1.0000    0.1554    1.0000    0.1884    1.0000    1.0000    0.6980    1.0000    0.8352    1.0000    0.6865    0.6766    0.8799 0.9289    0.8325         0    0.7363]);
pnet.CPD{38} = tabular_CPD(pnet, 38,[   0    1.0000    0.6855    1.0000    0.9510    1.0000    0.6897    1.0000    0.3291    1.0000    0.3345    1.0000    0.2433    1.0000  0.6712    1.0000    0.5201    1.0000    1.0000    0.5435    1.0000    0.3607    1.0000    0.9831    1.0000         0    1.0000    0.9736  1.0000    0.3953    1.0000    0.3653    1.0000    0.9617    1.0000    0.4556]);
pnet.CPD{39} = tabular_CPD(pnet, 39,[ 0.2109    1.0000    1.0000    0.5490    0.6110    0.8675]);
pnet.CPD{40} = tabular_CPD(pnet, 40,[0.9442    1.0000    1.0000    0.7206]);

evidence = cell(1,N);

evidence{21} = 1;  
evidence{29} = 1;  
var_interest= 38;
instance_interest=1;
evidence_new=evidence;
evidence_new{var_interest} = instance_interest;  


disp('----------------nouveau--n-----------');
engine = MG_inf_engine(pnet);

tic; [Bel_Cdt_new] = global_propagation(engine, evidence_new,  [],[],0,1000); toc;

Bel_Cdt_new


disp('----------------nouveau 1-----------');
engine = MG_inf_engine(pnet);
tic; [Bel_Cdt_new] = global_propagation(engine, evidence_new,  [],[], 0,1); toc;

Bel_Cdt_new


disp('----------------classique-------------');
engine = jtree_inf_engine(pnet);
tic; [engine] = global_propagation(engine, evidence); toc;
%affichage pour A
marg = marginal_nodes(engine, var_interest);
BEL_Cdt_classique=marg.T(instance_interest)

disp('----------------nouveau--2-----------');
engine = MG_inf_engine(pnet);

tic; [Bel_Cdt_new] = global_propagation(engine, evidence_new, [],[],0,2); toc;

Bel_Cdt_new

disp('----------------nouveau--3-----------');
engine = MG_inf_engine(pnet);

tic; [Bel_Cdt_new] = global_propagation(engine, evidence_new,  [],[],0,3); toc;

Bel_Cdt_new

disp('----------------nouveau--n-best----------');
engine = MG_inf_engine(pnet);

tic; [Bel_Cdt_new] = global_propagation(engine, evidence_new,  [],[],0,500); toc;

Bel_Cdt_new

disp('----------------nouveau--n-----------');
engine = MG_inf_engine(pnet);

tic; [Bel_Cdt_new] = global_propagation(engine, evidence_new,  [],[],0,1000); toc;

Bel_Cdt_new

disp('----------------classique-------------');
engine = jtree_inf_engine(pnet);
tic; [engine] = global_propagation(engine, evidence); toc;
%affichage pour A
marg = marginal_nodes(engine, var_interest);
BEL_Cdt_classique=marg.T(instance_interest)
